<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arrays and Data Structures - Tests</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
        }
        .pass {
            background-color: #e8f5e9;
            color: #2e7d32;
            border-left: 4px solid #2e7d32;
        }
        .fail {
            background-color: #fbe9e7;
            color: #c62828;
            border-left: 4px solid #c62828;
        }
        .console-output {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            margin-top: 5px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        .summary {
            margin-top: 20px;
            padding: 15px;
            background: #e3f2fd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Arrays and Data Structures - Test Results</h1>
        <div id="test-results"></div>
        <div id="summary" class="summary"></div>
    </div>

    <script type="module">
        // Import student's code
        import * as exercises from './exercises.js';

        // Test runner
        class TestRunner {
            constructor() {
                this.results = [];
                this.passCount = 0;
                this.totalTests = 0;
            }

            assert(condition, message) {
                if (!condition) {
                    throw new Error(message);
                }
            }

            assertArrayEquals(actual, expected) {
                const actualStr = JSON.stringify(actual);
                const expectedStr = JSON.stringify(expected);
                if (actualStr !== expectedStr) {
                    throw new Error(`Expected ${expectedStr} but got ${actualStr}`);
                }
            }

            addResult(testName, passed, error = null) {
                this.results.push({ testName, passed, error });
                if (passed) this.passCount++;
                this.totalTests++;
            }

            displayResults() {
                const container = document.getElementById('test-results');
                const summary = document.getElementById('summary');
                
                this.results.forEach(result => {
                    const div = document.createElement('div');
                    div.className = `test-result ${result.passed ? 'pass' : 'fail'}`;
                    div.textContent = `${result.passed ? '✅' : '❌'} ${result.testName}`;
                    
                    if (!result.passed && result.error) {
                        const errorDiv = document.createElement('div');
                        errorDiv.className = 'console-output';
                        errorDiv.textContent = result.error;
                        div.appendChild(errorDiv);
                    }
                    
                    container.appendChild(div);
                });

                summary.textContent = `Passed ${this.passCount} of ${this.totalTests} tests (${Math.round(this.passCount/this.totalTests*100)}%)`;
            }

            runTest(testName, testFn) {
                try {
                    testFn();
                    this.addResult(testName, true);
                } catch (error) {
                    this.addResult(testName, false, error.message);
                }
            }
        }

        // Initialize test runner
        const runner = new TestRunner();

        // Run tests
        runner.runTest('Array Operations - Find Largest Number', () => {
            runner.assert(exercises.findLargestNumber([5, 3, 9, 1, 7]) === 9, 'Should find largest number 9');
            runner.assert(exercises.findLargestNumber([-1, -5, -2]) === -1, 'Should handle negative numbers');
            runner.assert(exercises.findLargestNumber([1]) === 1, 'Should handle single number');
        });

        runner.runTest('Array Operations - Remove Duplicates', () => {
            runner.assertArrayEquals(
                exercises.removeDuplicates([1, 2, 2, 3, 3, 4]),
                [1, 2, 3, 4]
            );
            runner.assertArrayEquals(
                exercises.removeDuplicates([1, 1, 1]),
                [1]
            );
            runner.assertArrayEquals(
                exercises.removeDuplicates([1, 2, 3]),
                [1, 2, 3]
            );
        });

        runner.runTest('Array Operations - Custom Reverse', () => {
            runner.assertArrayEquals(
                exercises.customReverse([1, 2, 3, 4, 5]),
                [5, 4, 3, 2, 1]
            );
            runner.assertArrayEquals(
                exercises.customReverse([1]),
                [1]
            );
            runner.assertArrayEquals(
                exercises.customReverse([]),
                []
            );
        });

        runner.runTest('Shopping List - Add Items', () => {
            exercises.shoppingList.items = []; // Reset list
            exercises.shoppingList.addItem("Apples", 5);
            exercises.shoppingList.addItem("Bananas");
            
            runner.assert(exercises.shoppingList.items.length === 2, 'Should have 2 items');
            runner.assert(exercises.shoppingList.items.find(item => item.name === "Apples").quantity === 5,
                'Apples quantity should be 5');
            runner.assert(exercises.shoppingList.items.find(item => item.name === "Bananas").quantity === 1,
                'Bananas should have default quantity 1');
        });

        runner.runTest('Shopping List - Update Quantity', () => {
            exercises.shoppingList.items = [{ name: "Apples", quantity: 5 }];
            exercises.shoppingList.updateQuantity("Apples", 7);
            
            runner.assert(exercises.shoppingList.items[0].quantity === 7,
                'Should update Apples quantity to 7');
        });

        runner.runTest('Shopping List - Remove Item', () => {
            exercises.shoppingList.items = [
                { name: "Apples", quantity: 5 },
                { name: "Bananas", quantity: 3 }
            ];
            exercises.shoppingList.removeItem("Bananas");
            
            runner.assert(exercises.shoppingList.items.length === 1,
                'Should have 1 item after removal');
            runner.assert(!exercises.shoppingList.items.find(item => item.name === "Bananas"),
                'Bananas should be removed');
        });

        runner.runTest('Grade Tracker - Add Student', () => {
            exercises.gradeTracker.students = []; // Reset tracker
            exercises.gradeTracker.addStudent("John", [85, 90, 87]);
            
            runner.assert(exercises.gradeTracker.students.length === 1,
                'Should have 1 student');
            runner.assertArrayEquals(
                exercises.gradeTracker.students[0].grades,
                [85, 90, 87]
            );
        });

        runner.runTest('Grade Tracker - Calculate Average', () => {
            exercises.gradeTracker.students = [
                { name: "John", grades: [85, 90, 87] }
            ];
            
            runner.assert(exercises.gradeTracker.calculateAverage("John") === 87.33333333333333,
                'Should calculate correct average');
        });

        runner.runTest('Grade Tracker - Find Top Performer', () => {
            exercises.gradeTracker.students = [
                { name: "John", grades: [85, 90, 87] },
                { name: "Jane", grades: [92, 88, 95] }
            ];
            
            runner.assert(exercises.gradeTracker.findTopPerformer() === "Jane",
                'Should find Jane as top performer');
        });

        runner.runTest('Library - Add Book', () => {
            exercises.library.books = []; // Reset library
            exercises.library.addBook("The Hobbit", "J.R.R. Tolkien", "Fantasy", "978-0547928227");
            
            runner.assert(exercises.library.books.length === 1,
                'Should have 1 book');
            runner.assert(exercises.library.books[0].title === "The Hobbit",
                'Should store correct book title');
        });

        runner.runTest('Library - Search Books', () => {
            exercises.library.books = [
                { title: "The Hobbit", author: "J.R.R. Tolkien", genre: "Fantasy", isbn: "978-0547928227" },
                { title: "1984", author: "George Orwell", genre: "Science Fiction", isbn: "978-0451524935" }
            ];
            
            const fantasyBooks = exercises.library.searchBooks({ genre: "Fantasy" });
            runner.assert(fantasyBooks.length === 1,
                'Should find 1 Fantasy book');
            runner.assert(fantasyBooks[0].title === "The Hobbit",
                'Should find The Hobbit');
        });

        runner.runTest('Library - Borrow and Return Books', () => {
            exercises.library.books = [
                { title: "The Hobbit", author: "J.R.R. Tolkien", genre: "Fantasy", isbn: "978-0547928227", available: true }
            ];
            
            exercises.library.borrowBook("978-0547928227", "John Smith");
            runner.assert(!exercises.library.books[0].available,
                'Book should be marked as unavailable');
            
            exercises.library.returnBook("978-0547928227");
            runner.assert(exercises.library.books[0].available,
                'Book should be marked as available after return');
        });

        runner.runTest('Data Transformation - Filter by Category', () => {
            const electronics = exercises.filterByCategory(exercises.salesData, "Electronics");
            runner.assert(electronics.length === 2,
                'Should find 2 Electronics items');
            runner.assert(electronics.every(item => item.category === "Electronics"),
                'All items should be Electronics');
        });

        runner.runTest('Data Transformation - Category Totals', () => {
            const totals = exercises.calculateCategoryTotals(exercises.salesData);
            runner.assert(totals.Electronics === 5299.85,
                'Electronics total should be 5299.85');
            runner.assert(totals.Furniture === 599.97,
                'Furniture total should be 599.97');
        });

        runner.runTest('Data Transformation - Transform Data', () => {
            const transformed = exercises.transformData(exercises.salesData);
            runner.assert(transformed.Electronics.items.length === 2,
                'Electronics should have 2 items');
            runner.assert(transformed.Electronics.subtotal === 5299.85,
                'Electronics subtotal should be 5299.85');
            runner.assert(transformed.Furniture.items.length === 1,
                'Furniture should have 1 item');
        });

        // Display results
        runner.displayResults();
    </script>
</body>
</html> 